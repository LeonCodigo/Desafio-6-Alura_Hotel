package DAO;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.Statement;

import modelo.Reserva;

public class ReservaDAO 
{
   private Connection coneccion; 
	
	public ReservaDAO(Connection coneccion)
	{
		this.coneccion =coneccion;
	}
	
	public void guardar(Reserva reserva)                                                                      /*1*/
	{
		String sql = "INSERT INTO reservas (fecha_entrada, fecha_salida, valor, forma_pago)"     
				+ "VALUES (?,?,?,?)";
		try (PreparedStatement preState = coneccion.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS))   /*2*/
		{
			preState.setDate(1, reserva.getFechaEn());                                                        /*3*/
			preState.setDate(2, reserva.getFechaSal());
			preState.setString(3, reserva.getValor());
			preState.setString(4, reserva.getFormaPago());
			
			preState.executeUpdate();
		} 
		catch (Exception e)
		{
		   
		}
		
	}
	
}






/* Clase ReservaDAO --> Se encarga de mantener la connecion con la base de datos, ademas contiene las reglas de negocio
 * contiene los metodos CRUD. Es la clase que se va a instanciar en otra para poder usar los metodos que modifiquen la base
 * de datos. Para esto necesita tambien tener una variable coneccion que la recibe desde la clase que la instancie. 
 * 
 * 1 --> Metodo guardar, creamos el String con el Query, en lugar de los valores usamos un " ? " -> por cada variable.
 * esto se hace usando PreparedStatemen, que justamente prepara el Query. 
 * 
 * 2 --> Statement.RETURN_GENERATED_KEYS => devuelve la clave auto generada, para usarla en el momento de guardar los datos
 * y ademas le enviamos el Query en forma de texto 
 * 
 * 3 --> Una vez que tenemos el Query y el dato auto generado del ID, podemos setear los datos que obtenemos como parametro
 * en el mentodo en reseserva
 * 
 * 4 --> Pedimos que se actualize con los datos de PreparedStatemen, la base de datos. 
 * 
 */